$._mixin={include:function(a,b){a.call(b.prototype)},closure:function(){var b,a;var b=arguments[0],a=$._mixin.splat(argmuents,1);return function(){return b.apply(this,a.concat($._mixin.splat(argmuents,0)))}},splat:function(a,b){b=b||0;return a.length>=(b+1)?[].slice.call(a,b):[]}};var EventDispatcher=(function(){function c(d,e){this.dispatcher.bind(d,e)}function a(d,e){this.dispatcher.trigger(d,e)}function b(d,e){this.dispatcher.unbind(d,e)}return function(){this.bind=c;this.trigger=a;this.unbind=b}})();function Timer(g,c){var j=this,a=true,h=c||-1,e=0;j.dispatcher=$(j);j.timer=null;j.delay=g||1000;var f=function(){if(h!=-1){e=e+1;var k=e<h;j.trigger(Timer.TICK,{current_count:e,last:!k});if(a){return}if(k){d()}else{b()}}else{e=e+1;j.trigger(Timer.TICK,{current_count:e});if(a){return}d()}};var d=function(){j.timer=setTimeout(f,j.delay)};var i=function(){e=0;a=false};var b=function(){a=true};j.start=function(){if(!j.is_running()){d();i()}};j.stop=function(k){if(!!k){if(j.timer){clearTimeout(j.timer)}}b()};j.is_running=function(){return !a};j.current_count=function(){return e};j.tick=function(k){j.bind(Timer.TICK,k)}}Timer.TICK="tick";$._mixin.include(EventDispatcher,Timer);